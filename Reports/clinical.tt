<!DOCTYPE html>
<head>
<meta name="viewport" content="width=device-width" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style>
[% css %]
</style>
</head>

<body>
  [% PROCESS processing.tt %]

<section class="report">
  <h1 class="clinical">CLINICAL GENOME REPORT</h1>
  <div class="info-grid">
    <div class="list bordered">     
      	<item><label>Genome identifier</label><value>id-[% fields.id %]</value></item>
      	<item><label>Isolate/laboratory identifier</label><value>[% fields.isolate %]</value></item>
      	<item><label>Year of isolation</label><value>[% fields.isolation_year %]</value></item>
      	<item><label>Location</label><value>[% fields.city %], [% fields.country %]</value></item>     
    </div>
    <div class="list bordered">
      <item><label>Source type</label><value>[% fields.host %]</value></item>     
      <item><label>Host tissue sampled</label><value>[% fields.source_details %]</value></item>
      [% IF fields.accession_number %]
      	<item><label>Accession number</label><value>[% fields.accession_number %]</value></item>
      [% END %]
      
      <item><label>Genome report date</label><value>[% date %]</value></item>
      <item><label>Genome quality</label><value>[% genome_quality %]</item>
    </div>
  </div>

  <h2 class="section-title clinical">Section 1: Clinical microbiology</h2>
  <div class="summary-box clinical list">  
    <item><label>Summary</label>
    <value>[% clinical_summary %]</value></item>  
  </div>

  <div class="summary-box organism list">
    <item><label>Organism</label><value>[% species_format.$species || species %]</value></item>
  </div>

<div class="content typing">
<div class="list">
<item><label>Bacterial typing</label><value class="description">
subspecies characterisation and classification to assess isolate similarity 
<a href="https://pubmlst.org/multilocus-sequence-typing" target="_blank">
<span style="white-space: nowrap">https://pubmlst.org/multilocus-sequence-typing</span></a></value>
</item></div>
<div class="info-grid">
<div class="st">
MLST (Multilocus sequence typing)<br />
Sequence type (ST): 
[% IF st %][% st %][% ELSE %]Not yet defined.[% END %]
</div>
[% IF st %]
	<div class="profile">
	[% mlst_profile %]
	</div>
[% END %]
</div>
</div>

<div class="content amr">
[% IF !Kleb %]
<div class="list">
<item><label>Antibiotic resistance determinants</label><value class="critical">Kleborate has not run.</value></item>
</div>
[% ELSE %]
<div class="list">
<item><label>Antibiotic resistance determinants</label>
<value class="description">Genetically determined resistance mechanisms have been identified. 
Genetic variants (homologs) are highlighted *. "None found" means no resistance mechanisms 
have been identified in the antimicrobial resistance databases that exist at the time of 
reporting, correlate with phenotype. It is best practice to review these with the phenotypic 
antibiotic susceptibility profile. 
<a href="https://github.com/klebgenomics/Kleborate" target="_blank">
<span style="white-space:nowrap">https://github.com/klebgenomics/Kleborate</span></a>.</value></item>
</div>

<div class="scrollable">
<table class="amr">
<tr><th>Drug class</th><th>Acquired genotypes</th></tr>
<tr><td>Penicillins (expected resistance due to blaSHV)</td><td>[% penicillin_output %]</td></tr>
<tr><td>  + &beta;-lactamase inhibitor</td><td>[% penicillin_bla_inh_output %]</td></tr>
<tr><td>Cephalosporins (3<sup>rd</sup> gen)</td><td>[% cephalosporin_output %]</td></tr>
<tr><td>  + &beta;-lactamase inhibitor</td><td>[% cephalosporin_bla_inh_output %]</td></tr>
<tr><td>Carbapenems</td><td>[% carbapenems_output %]</td></tr>
<tr><td>Porin mutations (multiple drug classes)</td><td>[% porin_output %]</td></tr>
<tr><td>Aminoglycosides</td><td>[% aminogylcocides_output %]</td></tr>
<tr><td>Fluoroquinolones</td><td>[% fluoroquinolones_output %]</td></tr>
<tr><td>Fosfomycin</td><td>[% fosfomycin_output %]</td></tr>
<tr><td>Phenicols</td><td>[% phenicols_output %]</td></tr>
<tr><td>Polymixins</td><td>[% polymixin_output %]</td></tr>
<tr><td>Tigecycline</td><td>[% tigecycline_output %]</td></tr>
<tr><td>Trimethoprim</td><td>[% trimethoprim_output %]</td></tr>
<tr><td>  + Sulfonamides</td><td>[% sulfonamides_output %]</td></tr>
</table></div>
[% END %]
</div>

<div class="content capsule">
[% IF !Kleb %]
<div class="list">
<item><label>Capsule and O typing</label><value class="critical">Kapsule has not run.</value></item>
</div>
[% ELSE %]
<div class="list"><item><label>Capsule and O typing</label><value class="description">
Polysaccharide K and lipopolysaccharide O serotypes as predicted by KL and O genotype 
<a href="https://github.com/klebgenomics/Kaptive" target="_blank"><span style="white-space: nowrap">
https://github.com/klebgenomics/Kaptive</span></a>.</value></item></div>
<div class="info-grid">
<div class="list"><item><label class="discrete"><em>K type</em></label>
<value><em>[% Kleb.K_type %]</em></value></item></div>
<div class="list"><item><label class="discrete"><em>O type</em></label>
<value><em>[% Kleb.O_type %]</em></value></item></div>
</div>
[% END %]
</div>

<div class="content virulence">
[% IF !Kleb %]
<div class="list">
<item><label>Virulence factors</label><value class="critical">Kleborate has not run.</value></item>
</div>
[% ELSE %]
<div class="list">
<item><label>Virulence factors</label><value class="description">Factors that may lead to increased 
ability to cause invasive disease <a href="https://github.com/klebgenomics/Kleborate" target="_blank">
<span style="white-space:nowrap">https://github.com/klebgenomics/Kleborate</span></a>.</value></item>
<div class="list">
<item><label class="discrete">Virulence score</label><value>[% Kleb.virulence_score %]</value></item>
</div>

<div class="info-grid">
<div class="list">
<item><label>Acquired siderophores</label></item>
<item><label class="discrete">Aerobactin ST</label><value>[% aerobactin_output %]</value></item>
<item><label class="discrete">Salmochelin ST</label><value>[% salmochelin_output %]</value></item>
<item><label class="discrete">Yersiniabactin ST</label><value>[% yersiniabactin_output %]</value></item>
</div>
<div class="list">
<item><label>Other factors</label></item>
<item><label class="discrete">Colibactin ST</label><value>[% colibactin_output %]</value></item>
<item><label class="discrete">Hypermucoidy</label><value>[% hypermucoidy_output %]</value></item>
</div></div>
</div>
[% END %]
</div>

<h2 class="section-title public_health" style="margin-top:2rem">
Section 2: Public health and Infection prevention and control</h2>
<div class="summary-box public_health list">  
  <item><label>Summary</label>
  <value>[% public_health_summary %]</value></item>  
</div>

<div class="content typing">
<div class="list">
<item><label>Bacterial typing</label><value class="description">
subspecies characterisation and classification to assess isolate similarity 
<a href="https://pubmlst.org/multilocus-sequence-typing" target="_blank">
<span style="white-space: nowrap">https://pubmlst.org/multilocus-sequence-typing</span></a></value>
</item></div>
<div class="info-grid">
<div class="st">
MLST (Multilocus sequence typing)<br />
Sequence type (ST): 
[% IF st %][% st %][% ELSE %]Not yet defined.[% END %]
</div>
[% IF st %]
	<div class="profile">
	[% mlst_profile %]
	</div>
[% END %]
</div>
[% IF lincodes.lincode %]
<div class="info-grid">
<div class="list"><item><label class="discrete">Phylogroup</label>
<value>[% phylogroup_output %]</value></item></div>
<div class="list"><item><label class="discrete">Sublineage</label>
<value>[% sublineage_output %]</value></item></div>
<div class="list"><item><label class="discrete">Clonal group</label>
<value>[% clonal_group_output %]</value></item></div>
<div class="list"><item><label class="discrete">cgST</label>
<value>[% scgst %]</value></item></div>
</div>
<div class="list">
<item><label class="discrete">LIN (Life Identification Number)</label><value>[% lincodes.lincode %]</value></item>
</div>
[% ELSE %]
<div class="list">
<item><label class="discrete">LIN (Life Identification Number)</label><value>Not defined.</value></item>
</div>
[% END %]
</div>

<div class="content plasmid">
[% IF !analysis.PlasmidFinder %]
<div class="list">
<item><label>Plasmid Inc typing</label>
<value class="critical">PlasmidFinder has not run.</value></item>
</div>
[% ELSE %]
<div class="list">
<item><label>Plasmid Inc typing</label><value class="description">
 Plasmid replicons that are extracted from short sequence read data may be less reliable than from long read data 
<a href="https://cge.food.dtu.dk/services/PlasmidFinder/" target="_blank">
<span style="white-space: nowrap">https://cge.food.dtu.dk/services/PlasmidFinder/</span></a></value>
</item>
<item><label class="discrete">Plasmid type</label><value>[% plasmid_output %]</value></item>
</div>

[% END %]
</div>

<div class="content outbreak">
<div class="list">
<item><label>Outbreak analysis</label><value class="description">Identifying isolates that are genetically 
similar and maybe part of a transmission chain 
<a href="https://bigsdb.pasteur.fr/klebsiella/cgmlst-lincodes/" target="_blank">
<span style="white-space: nowrap">https://bigsdb.pasteur.fr/klebsiella/cgmlst-lincodes/</span></a>.
</value></item>
</div>
[% IF lincodes.lincode %]
<p class="heading">Allele based:</p>
<div class="list">
<item><label class="discrete">LIN (Life Identification Number)</label><value>[% lincodes.lincode %]</value></item>
<p class="note" style="margin-top:0">(based on cgMLST scheme with 629 genes)</p>
</div>

[% cluster_summary %]
<div class="info-grid">
<div class="scrollable">
[% lincode_clusters %]
</div>
[% IF lincodes.clusters.5.similar %]
<div class="captioned_image">
<p class="caption">Further single nucleotide analysis may be required for isolates 
that have identical LIN codes.</p>
<img style="width:200px;max-width:200px" src="data:image/png;base64,[% images.Pairwise_LIN_codes %]" />
</div>
[% END %]
</div>

[% ELSE %]
<div class="list">
<item><label class="discrete">LIN (Life Identification Number)</label><value>Not defined.</value></item>
</div>
[% END %]
</div>

</section>
</body>
</html>